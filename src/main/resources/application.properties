# =============================================================================
# APPLICATION
# =============================================================================
spring.application.name=${APP_NAME:finapp}

# =============================================================================
# SERVER
# =============================================================================
server.port=${SERVER_PORT:8080}
server.address=${SERVER_ADDRESS:0.0.0.0}
server.compression.enabled=${SERVER_COMPRESSION_ENABLED:true}
server.http2.enabled=${SERVER_HTTP2_ENABLED:true}
server.tomcat.connection-timeout=${SERVER_CONNECTION_TIMEOUT:30000}
server.tomcat.keep-alive-timeout=${SERVER_KEEP_ALIVE_TIMEOUT:60000}
server.tomcat.threads.max=200
server.tomcat.threads.min-spare=10
server.error.include-message=always
server.error.include-stacktrace=on_param

# =============================================================================
# DATABASE
# =============================================================================
spring.datasource.driver-class-name=org.postgresql.Driver
spring.datasource.url=${DB_URL}
spring.datasource.username=${DB_USERNAME}
spring.datasource.password=${DB_PASSWORD}

# HikariCP Connection Pool
spring.datasource.hikari.minimum-idle=${DB_POOL_SIZE_MIN:5}
spring.datasource.hikari.maximum-pool-size=${DB_POOL_SIZE_MAX:20}
spring.datasource.hikari.connection-timeout=${DB_POOL_TIMEOUT:30000}
spring.datasource.hikari.idle-timeout=${DB_POOL_IDLE_TIMEOUT:600000}
spring.datasource.hikari.max-lifetime=${DB_POOL_MAX_LIFETIME:1800000}
spring.datasource.hikari.connection-test-query=${DB_POOL_CONNECTION_TEST_QUERY:SELECT 1}
spring.datasource.hikari.pool-name=FinAppHikariPool
spring.datasource.hikari.auto-commit=true
spring.datasource.hikari.leak-detection-threshold=60000

# =============================================================================
# JPA/HIBERNATE
# =============================================================================
spring.jpa.show-sql=${JPA_SHOW_SQL:false}
spring.jpa.hibernate.ddl-auto=${JPA_DDL_AUTO:update}
spring.jpa.open-in-view=${JPA_OPEN_IN_VIEW:false}
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.use_sql_comments=true
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.time_zone=UTC
spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl

# =============================================================================
# SECURITY
# =============================================================================
spring.security.user.name=${SECURITY_USER}
spring.security.user.password=${SECURITY_PASSWORD}

# JWT Configuration
jwt.secret=${JWT_SECRET}
jwt.expiration=${JWT_EXPIRATION}
jwt.refresh-expiration=${JWT_REFRESH_EXPIRATION:604800000}

# Cookie Settings
cookie.name=${COOKIE_NAME:auth-token}
cookie.secure=${COOKIE_SECURE:false}
cookie.http-only=${COOKIE_HTTP_ONLY:true}
cookie.same-site=${COOKIE_SAME_SITE:Strict}
cookie.max-age=${COOKIE_MAX_AGE:900}
cookie.path=${COOKIE_PATH:/}

# CORS Configuration
cors.allowed-origins=${CORS_ALLOWED_ORIGINS:http://localhost:3000,http://localhost:8080}
cors.allowed-methods=${CORS_ALLOWED_METHODS:GET,POST,PUT,DELETE,PATCH,OPTIONS}
cors.allowed-headers=${CORS_ALLOWED_HEADERS:*}
cors.allow-credentials=${CORS_ALLOW_CREDENTIALS:true}
cors.max-age=${CORS_MAX_AGE:3600}

# =============================================================================
# RATE LIMITING
# =============================================================================
rate-limit.global.capacity=${RATE_LIMIT_GLOBAL_CAPACITY:100}
rate-limit.global.refill-tokens=${RATE_LIMIT_GLOBAL_REFILL_TOKENS:100}
rate-limit.global.refill-duration=${RATE_LIMIT_GLOBAL_REFILL_DURATION:60}

rate-limit.auth.capacity=${RATE_LIMIT_AUTH_CAPACITY:10}
rate-limit.auth.refill-tokens=${RATE_LIMIT_AUTH_REFILL_TOKENS:10}
rate-limit.auth.refill-duration=${RATE_LIMIT_AUTH_REFILL_DURATION:60}

rate-limit.api.capacity=${RATE_LIMIT_API_CAPACITY:60}
rate-limit.api.refill-tokens=${RATE_LIMIT_API_REFILL_TOKENS:60}
rate-limit.api.refill-duration=${RATE_LIMIT_API_REFILL_DURATION:60}

# =============================================================================
# LOGGING
# =============================================================================
logging.level.root=${LOG_LEVEL_ROOT:INFO}
logging.level.com.rain.finapp=${LOG_LEVEL_APP:DEBUG}
logging.level.org.springframework=${LOG_LEVEL_SPRING:INFO}
logging.level.org.hibernate=${LOG_LEVEL_HIBERNATE:INFO}
logging.level.org.springframework.security=${LOG_LEVEL_SECURITY:DEBUG}
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# Log file settings
logging.file.name=${LOG_FILE_NAME:finapp.log}
logging.file.max-size=${LOG_FILE_MAX_SIZE:10MB}
logging.file.max-history=${LOG_FILE_MAX_HISTORY:30}
logging.file.total-size-cap=${LOG_FILE_TOTAL_SIZE_CAP:500MB}

# =============================================================================
# ACTUATOR & MONITORING
# =============================================================================
management.endpoints.enabled-by-default=${ACTUATOR_ENABLED:true}
management.endpoints.web.base-path=${ACTUATOR_BASE_PATH:/actuator}
management.endpoints.web.exposure.include=${ACTUATOR_ENDPOINTS_ENABLED:health,info,metrics,prometheus}
management.endpoint.health.show-details=${ACTUATOR_HEALTH_SHOW_DETAILS:when-authorized}
management.metrics.export.prometheus.enabled=true
management.health.defaults.enabled=true
management.health.db.enabled=true

# =============================================================================
# CACHE
# =============================================================================
spring.cache.type=${CACHE_TYPE:simple}
spring.cache.cache-names=users,transactions,categories
spring.cache.caffeine.spec=maximumSize=1000,expireAfterWrite=${CACHE_TTL:3600}s

# =============================================================================
# FILE UPLOAD
# =============================================================================
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=${FILE_UPLOAD_MAX_SIZE:5MB}
spring.servlet.multipart.max-request-size=${FILE_UPLOAD_MAX_REQUEST_SIZE:10MB}

# =============================================================================
# THREAD POOL
# =============================================================================
spring.task.execution.pool.core-size=${THREAD_POOL_CORE_SIZE:10}
spring.task.execution.pool.max-size=${THREAD_POOL_MAX_SIZE:50}
spring.task.execution.pool.queue-capacity=${THREAD_POOL_QUEUE_CAPACITY:100}
spring.task.execution.pool.keep-alive=${THREAD_POOL_KEEP_ALIVE:60}s
spring.task.execution.thread-name-prefix=finapp-executor-

# =============================================================================
# PAGINATION
# =============================================================================
pagination.default-size=${PAGINATION_DEFAULT_SIZE:20}
pagination.max-size=${PAGINATION_MAX_SIZE:100}

# =============================================================================
# EMAIL (if needed)
# =============================================================================
spring.mail.host=${EMAIL_HOST:smtp.gmail.com}
spring.mail.port=${EMAIL_PORT:587}
spring.mail.username=${EMAIL_USERNAME:}
spring.mail.password=${EMAIL_PASSWORD:}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=${EMAIL_TLS_ENABLED:true}
spring.mail.default-encoding=UTF-8

# =============================================================================
# JSON
# =============================================================================
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.time-zone=UTC
spring.jackson.default-property-inclusion=non_null